{% extends "base.html" %}

{% block title %}Help & Documentation - acimig v1.0{% endblock %}
{% block page_title %}Help & Documentation{% endblock %}

{% block extra_css %}
<!-- Mermaid.js for flowcharts -->
<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script>
    mermaid.initialize({
        startOnLoad: true,
        theme: 'default',
        themeVariables: {
            primaryColor: '#3b82f6',
            primaryTextColor: '#fff',
            primaryBorderColor: '#2563eb',
            lineColor: '#64748b',
            secondaryColor: '#8b5cf6',
            tertiaryColor: '#10b981'
        }
    });
</script>
{% endblock %}

{% block content %}

<!-- Page Header -->
<div class="mb-8">
    <h1 class="text-3xl font-bold text-gray-900 flex items-center">
        <svg class="h-8 w-8 mr-3 text-primary-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
        </svg>
        Help & Documentation
    </h1>
    <p class="mt-2 text-lg text-gray-600">
        Everything you need to know about using the ACI Analysis Tool
    </p>
</div>

<!-- Quick Start Guide -->
<div class="bg-white rounded-xl shadow-lg border border-gray-100 mb-8 overflow-hidden">
    <div class="px-6 py-4 bg-gradient-to-r from-primary-50 to-white border-b border-gray-200">
        <h2 class="text-2xl font-bold text-gray-900 flex items-center">
            <svg class="h-6 w-6 mr-2 text-primary-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
            </svg>
            Quick Start Guide
        </h2>
    </div>
    <div class="p-6 space-y-6">
        <div class="flex items-start">
            <div class="flex-shrink-0 h-10 w-10 rounded-lg bg-blue-100 flex items-center justify-center text-blue-600 font-bold mr-4">
                1
            </div>
            <div class="flex-1">
                <h3 class="text-lg font-semibold text-gray-900 mb-2">Create or Select a Fabric</h3>
                <p class="text-gray-700 mb-3">Start by creating a new fabric or selecting an existing one from the home page. Choose your analysis mode:</p>
                <ul class="space-y-2">
                    <li class="flex items-start">
                        <svg class="h-5 w-5 text-blue-600 mr-2 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                        </svg>
                        <span class="text-gray-700"><strong class="text-gray-900">Offboard:</strong> Analyze FEX consolidation opportunities and decommissioning candidates</span>
                    </li>
                    <li class="flex items-start">
                        <svg class="h-5 w-5 text-green-600 mr-2 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                        </svg>
                        <span class="text-gray-700"><strong class="text-gray-900">Onboard:</strong> Plan new FEX deployments and capacity requirements</span>
                    </li>
                    <li class="flex items-start">
                        <svg class="h-5 w-5 text-purple-600 mr-2 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                        </svg>
                        <span class="text-gray-700"><strong class="text-gray-900">EVPN Migration:</strong> Plan migration from ACI to EVPN fabric</span>
                    </li>
                </ul>
            </div>
        </div>

        <div class="flex items-start">
            <div class="flex-shrink-0 h-10 w-10 rounded-lg bg-green-100 flex items-center justify-center text-green-600 font-bold mr-4">
                2
            </div>
            <div class="flex-1">
                <h3 class="text-lg font-semibold text-gray-900 mb-2">Upload Data</h3>
                <p class="text-gray-700 mb-3">Upload your ACI fabric data in JSON or XML format, and optionally provide CMDB data for enhanced correlation:</p>
                <ul class="space-y-2">
                    <li class="flex items-start">
                        <svg class="h-5 w-5 text-green-600 mr-2 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                        </svg>
                        <span class="text-gray-700"><strong class="text-gray-900">ACI Data:</strong> Export from APIC using moquery or API calls</span>
                    </li>
                    <li class="flex items-start">
                        <svg class="h-5 w-5 text-green-600 mr-2 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                        </svg>
                        <span class="text-gray-700"><strong class="text-gray-900">CMDB Data:</strong> CSV file with device serial numbers, locations, and metadata</span>
                    </li>
                </ul>
            </div>
        </div>

        <div class="flex items-start">
            <div class="flex-shrink-0 h-10 w-10 rounded-lg bg-purple-100 flex items-center justify-center text-purple-600 font-bold mr-4">
                3
            </div>
            <div class="flex-1">
                <h3 class="text-lg font-semibold text-gray-900 mb-2">Analyze</h3>
                <p class="text-gray-700">Navigate to the Analyze page to validate your data and run comprehensive analysis</p>
            </div>
        </div>

        <div class="flex items-start">
            <div class="flex-shrink-0 h-10 w-10 rounded-lg bg-yellow-100 flex items-center justify-center text-yellow-600 font-bold mr-4">
                4
            </div>
            <div class="flex-1">
                <h3 class="text-lg font-semibold text-gray-900 mb-2">Visualize</h3>
                <p class="text-gray-700">Explore interactive dashboards with charts, graphs, and topology visualizations</p>
            </div>
        </div>

        <div class="flex items-start">
            <div class="flex-shrink-0 h-10 w-10 rounded-lg bg-red-100 flex items-center justify-center text-red-600 font-bold mr-4">
                5
            </div>
            <div class="flex-1">
                <h3 class="text-lg font-semibold text-gray-900 mb-2">Plan & Report</h3>
                <p class="text-gray-700">Generate migration plans and comprehensive reports for stakeholders</p>
            </div>
        </div>
    </div>
</div>

<!-- Logic Flow Diagrams Section -->
<div class="mb-8">
    <h2 class="text-2xl font-bold text-gray-900 mb-6 flex items-center">
        <span class="h-1 w-8 bg-primary-600 mr-4 rounded-full"></span>
        System Logic Flows
    </h2>
    <p class="text-gray-600 mb-6">Interactive flowcharts showing how data flows through acimig v1.0</p>

    <!-- Data Upload Flow -->
    <div class="bg-white rounded-xl shadow-lg border border-gray-100 mb-8 overflow-hidden">
        <div class="px-6 py-4 bg-gradient-to-r from-blue-50 to-white border-b border-gray-200">
            <h3 class="text-xl font-bold text-gray-900 flex items-center">
                <svg class="h-5 w-5 mr-2 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
                </svg>
                Data Upload Flow
            </h3>
        </div>
        <div class="p-6">
            <div class="mermaid">
graph LR
    A[User Uploads File] --> B{File Type Check}
    B -->|JSON/XML| C[Parse ACI Data]
    B -->|CSV| D[Parse CMDB Data]
    B -->|TXT/CFG| E[Parse Legacy Config]
    B -->|Invalid| F[Show Error]
    C --> G[Validate Format]
    D --> G
    E --> G
    G -->|Valid| H[Extract Objects]
    G -->|Invalid| F
    H --> I[Categorize Data]
    I --> J[Store in Fabric]
    J --> K[Display Success]
    F --> L[User Corrects]
    L --> A
            </div>
        </div>
    </div>

    <!-- Analysis Flow -->
    <div class="bg-white rounded-xl shadow-lg border border-gray-100 mb-8 overflow-hidden">
        <div class="px-6 py-4 bg-gradient-to-r from-green-50 to-white border-b border-gray-200">
            <h3 class="text-xl font-bold text-gray-900 flex items-center">
                <svg class="h-5 w-5 mr-2 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                </svg>
                Analysis Flow
            </h3>
        </div>
        <div class="p-6">
            <div class="mermaid">
graph TD
    A[Select Fabric] --> B[Load All Datasets]
    B --> C[Initialize Analyzer]
    C --> D[Run Data Completeness Check]
    D --> E{Data Complete?}
    E -->|Yes| F[Categorize Objects]
    E -->|No| G[Show Missing Data Warning]
    G --> H[Continue with Available Data]
    F --> I[Analyze EPGs]
    F --> J[Analyze FEX Devices]
    F --> K[Analyze Interfaces]
    F --> L[Analyze Contracts]
    I --> M[Generate Statistics]
    J --> M
    K --> M
    L --> M
    M --> N[Display Results in Tables]
    N --> O[Enable Filtering & Search]
            </div>
        </div>
    </div>

    <!-- Migration Planning Flow -->
    <div class="bg-white rounded-xl shadow-lg border border-gray-100 mb-8 overflow-hidden">
        <div class="px-6 py-4 bg-gradient-to-r from-purple-50 to-white border-b border-gray-200">
            <h3 class="text-xl font-bold text-gray-900 flex items-center">
                <svg class="h-5 w-5 mr-2 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
                </svg>
                Migration Planning Flow
            </h3>
        </div>
        <div class="p-6">
            <div class="mermaid">
graph TD
    A[Start Planning] --> B{Mode?}
    B -->|EVPN| C[Analyze VPC Config]
    B -->|Onboard| D[Analyze Capacity]
    C --> E[Analyze Contracts]
    C --> F[Analyze L3Out]
    C --> G[Analyze VLAN Pools]
    E --> H[Generate ACL Mappings]
    F --> I[Document External Connectivity]
    G --> J[Plan VLAN Allocation]
    D --> K[Identify Available Ports]
    D --> L[Calculate Port Utilization]
    K --> M[Generate Recommendations]
    L --> M
    H --> N[Assess Migration Risk]
    I --> N
    J --> N
    N --> O[Prioritize by Complexity]
    M --> P[Generate Configuration]
    O --> P
    P --> Q[Export Reports]
            </div>
        </div>
    </div>

    <!-- Visualization Flow -->
    <div class="bg-white rounded-xl shadow-lg border border-gray-100 mb-8 overflow-hidden">
        <div class="px-6 py-4 bg-gradient-to-r from-yellow-50 to-white border-b border-gray-200">
            <h3 class="text-xl font-bold text-gray-900 flex items-center">
                <svg class="h-5 w-5 mr-2 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"/>
                </svg>
                Visualization Flow
            </h3>
        </div>
        <div class="p-6">
            <div class="mermaid">
graph LR
    A[Load Fabric Data] --> B[Run Analysis Engine]
    B --> C[Calculate Metrics]
    C --> D[Port Utilization]
    C --> E[VLAN Distribution]
    C --> F[EPG Complexity]
    C --> G[VPC Symmetry]
    D --> H[Generate Chart Data]
    E --> H
    F --> H
    G --> H
    H --> I[Render Interactive Charts]
    I --> J[Enable User Interaction]
    J --> K[Filter by Criteria]
    J --> L[Drill Down Details]
    K --> M[Update Visualizations]
    L --> M
            </div>
        </div>
    </div>

    <!-- Report Generation Flow -->
    <div class="bg-white rounded-xl shadow-lg border border-gray-100 mb-8 overflow-hidden">
        <div class="px-6 py-4 bg-gradient-to-r from-red-50 to-white border-b border-gray-200">
            <h3 class="text-xl font-bold text-gray-900 flex items-center">
                <svg class="h-5 w-5 mr-2 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                </svg>
                Report Generation Flow
            </h3>
        </div>
        <div class="p-6">
            <div class="mermaid">
graph TD
    A[Select Report Format] --> B{Format Type?}
    B -->|HTML| C[Generate Interactive HTML]
    B -->|Markdown| D[Generate Documentation MD]
    B -->|CSV| E[Generate Data Export]
    B -->|EVPN Config| F[Generate Device Configs]
    C --> G[Include Statistics]
    D --> G
    E --> G
    F --> H[Include Config Samples]
    G --> I[Add Recommendations]
    H --> I
    I --> J[Format Content]
    J --> K[Save to Output Directory]
    K --> L[Provide Download Link]
    L --> M[User Downloads Report]
            </div>
        </div>
    </div>

    <!-- Fabric Management Flow -->
    <div class="bg-white rounded-xl shadow-lg border border-gray-100 mb-8 overflow-hidden">
        <div class="px-6 py-4 bg-gradient-to-r from-teal-50 to-white border-b border-gray-200">
            <h3 class="text-xl font-bold text-gray-900 flex items-center">
                <svg class="h-5 w-5 mr-2 text-teal-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"/>
                </svg>
                Fabric Management Flow (Sidebar)
            </h3>
        </div>
        <div class="p-6">
            <div class="mermaid">
graph TD
    A[Open Fabric Manager in Sidebar] --> B{Action?}
    B -->|Create| C[Enter Fabric Name]
    B -->|Select| D[Choose from Dropdown]
    B -->|Delete| E[Confirm Deletion]
    C --> F[Validate Name]
    F -->|Valid| G[Create Directory]
    F -->|Invalid| H[Show Error]
    G --> I[Set as Current Fabric]
    I --> J[Reload Page]
    D --> K[Switch to Fabric]
    K --> J
    E --> L[Delete Fabric Data]
    L --> M[Clear Current Fabric]
    M --> J
    H --> N[User Corrects]
    N --> C
            </div>
        </div>
    </div>
</div>

<!-- ACI Objects Reference -->
<div class="bg-white rounded-xl shadow-lg border border-gray-100 mb-8 overflow-hidden">
    <div class="px-6 py-4 bg-gradient-to-r from-blue-50 to-white border-b border-gray-200">
        <h2 class="text-2xl font-bold text-gray-900 flex items-center">
            <svg class="h-6 w-6 mr-2 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/>
            </svg>
            ACI Objects Reference
        </h2>
    </div>
    <div class="divide-y divide-gray-200">
        <!-- eqptFex -->
        <details class="group">
            <summary class="cursor-pointer px-6 py-4 hover:bg-gray-50 transition-colors">
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <svg class="h-5 w-5 text-gray-400 mr-3 group-open:rotate-90 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                        </svg>
                        <h3 class="text-lg font-semibold text-gray-900">eqptFex <span class="text-sm font-normal text-gray-600">(FEX Equipment)</span></h3>
                    </div>
                    <span class="px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800">ACI Object</span>
                </div>
            </summary>
            <div class="px-6 py-4 bg-gray-50">
                <p class="text-gray-700 mb-4"><strong class="text-gray-900">Description:</strong> Represents a Fabric Extender (FEX) device in the ACI fabric.</p>
                <div class="mb-4">
                    <p class="text-sm font-semibold text-gray-900 mb-2">Key Attributes:</p>
                    <ul class="space-y-1">
                        <li class="text-sm text-gray-700"><code class="px-2 py-1 bg-gray-100 rounded text-xs">id</code> - Unique FEX identifier</li>
                        <li class="text-sm text-gray-700"><code class="px-2 py-1 bg-gray-100 rounded text-xs">model</code> - FEX model (e.g., N2K-C2348TQ)</li>
                        <li class="text-sm text-gray-700"><code class="px-2 py-1 bg-gray-100 rounded text-xs">serial</code> - Serial number</li>
                        <li class="text-sm text-gray-700"><code class="px-2 py-1 bg-gray-100 rounded text-xs">operSt</code> - Operational status (up/down)</li>
                    </ul>
                </div>
                <p class="text-sm text-gray-700"><strong class="text-gray-900">Analysis Use:</strong> Port utilization, consolidation scoring, topology mapping</p>
            </div>
        </details>

        <!-- fabricNode -->
        <details class="group">
            <summary class="cursor-pointer px-6 py-4 hover:bg-gray-50 transition-colors">
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <svg class="h-5 w-5 text-gray-400 mr-3 group-open:rotate-90 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                        </svg>
                        <h3 class="text-lg font-semibold text-gray-900">fabricNode <span class="text-sm font-normal text-gray-600">(Fabric Node)</span></h3>
                    </div>
                    <span class="px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">ACI Object</span>
                </div>
            </summary>
            <div class="px-6 py-4 bg-gray-50">
                <p class="text-gray-700 mb-4"><strong class="text-gray-900">Description:</strong> Represents a fabric node (leaf, spine, or APIC).</p>
                <div class="mb-4">
                    <p class="text-sm font-semibold text-gray-900 mb-2">Key Attributes:</p>
                    <ul class="space-y-1">
                        <li class="text-sm text-gray-700"><code class="px-2 py-1 bg-gray-100 rounded text-xs">id</code> - Node ID</li>
                        <li class="text-sm text-gray-700"><code class="px-2 py-1 bg-gray-100 rounded text-xs">name</code> - Node name</li>
                        <li class="text-sm text-gray-700"><code class="px-2 py-1 bg-gray-100 rounded text-xs">role</code> - Node role (leaf/spine/controller)</li>
                        <li class="text-sm text-gray-700"><code class="px-2 py-1 bg-gray-100 rounded text-xs">model</code> - Switch model</li>
                    </ul>
                </div>
                <p class="text-sm text-gray-700"><strong class="text-gray-900">Analysis Use:</strong> Topology mapping, capacity planning</p>
            </div>
        </details>

        <!-- fvAEPg -->
        <details class="group">
            <summary class="cursor-pointer px-6 py-4 hover:bg-gray-50 transition-colors">
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <svg class="h-5 w-5 text-gray-400 mr-3 group-open:rotate-90 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                        </svg>
                        <h3 class="text-lg font-semibold text-gray-900">fvAEPg <span class="text-sm font-normal text-gray-600">(Application EPG)</span></h3>
                    </div>
                    <span class="px-3 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800">ACI Object</span>
                </div>
            </summary>
            <div class="px-6 py-4 bg-gray-50">
                <p class="text-gray-700 mb-4"><strong class="text-gray-900">Description:</strong> Application Endpoint Group - collection of endpoints with common policy requirements.</p>
                <div class="mb-4">
                    <p class="text-sm font-semibold text-gray-900 mb-2">Key Attributes:</p>
                    <ul class="space-y-1">
                        <li class="text-sm text-gray-700"><code class="px-2 py-1 bg-gray-100 rounded text-xs">name</code> - EPG name</li>
                        <li class="text-sm text-gray-700"><code class="px-2 py-1 bg-gray-100 rounded text-xs">dn</code> - Distinguished name (contains tenant and app profile)</li>
                        <li class="text-sm text-gray-700"><code class="px-2 py-1 bg-gray-100 rounded text-xs">pcEnfPref</code> - Policy enforcement preference</li>
                    </ul>
                </div>
                <p class="text-sm text-gray-700"><strong class="text-gray-900">Analysis Use:</strong> Complexity scoring, migration waves, coupling analysis</p>
            </div>
        </details>

        <!-- fvRsPathAtt -->
        <details class="group">
            <summary class="cursor-pointer px-6 py-4 hover:bg-gray-50 transition-colors">
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <svg class="h-5 w-5 text-gray-400 mr-3 group-open:rotate-90 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                        </svg>
                        <h3 class="text-lg font-semibold text-gray-900">fvRsPathAtt <span class="text-sm font-normal text-gray-600">(EPG Path Attachment)</span></h3>
                    </div>
                    <span class="px-3 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">ACI Object</span>
                </div>
            </summary>
            <div class="px-6 py-4 bg-gray-50">
                <p class="text-gray-700 mb-4"><strong class="text-gray-900">Description:</strong> Links an EPG to a specific physical/virtual interface where endpoints reside.</p>
                <div class="mb-4">
                    <p class="text-sm font-semibold text-gray-900 mb-2">Key Attributes:</p>
                    <ul class="space-y-1">
                        <li class="text-sm text-gray-700"><code class="px-2 py-1 bg-gray-100 rounded text-xs">tDn</code> - Target distinguished name (path to interface)</li>
                        <li class="text-sm text-gray-700"><code class="px-2 py-1 bg-gray-100 rounded text-xs">encap</code> - Encapsulation (VLAN ID)</li>
                        <li class="text-sm text-gray-700"><code class="px-2 py-1 bg-gray-100 rounded text-xs">mode</code> - Deployment mode (regular/native/untagged)</li>
                    </ul>
                </div>
                <p class="text-sm text-gray-700"><strong class="text-gray-900">Analysis Use:</strong> VLAN distribution, coupling detection, VPC symmetry</p>
            </div>
        </details>

        <!-- fvBD -->
        <details class="group">
            <summary class="cursor-pointer px-6 py-4 hover:bg-gray-50 transition-colors">
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <svg class="h-5 w-5 text-gray-400 mr-3 group-open:rotate-90 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                        </svg>
                        <h3 class="text-lg font-semibold text-gray-900">fvBD <span class="text-sm font-normal text-gray-600">(Bridge Domain)</span></h3>
                    </div>
                    <span class="px-3 py-1 rounded-full text-xs font-medium bg-teal-100 text-teal-800">ACI Object</span>
                </div>
            </summary>
            <div class="px-6 py-4 bg-gray-50">
                <p class="text-gray-700 mb-4"><strong class="text-gray-900">Description:</strong> Layer 2 forwarding domain within a tenant.</p>
                <div class="mb-4">
                    <p class="text-sm font-semibold text-gray-900 mb-2">Key Attributes:</p>
                    <ul class="space-y-1">
                        <li class="text-sm text-gray-700"><code class="px-2 py-1 bg-gray-100 rounded text-xs">name</code> - BD name</li>
                        <li class="text-sm text-gray-700"><code class="px-2 py-1 bg-gray-100 rounded text-xs">arpFlood</code> - ARP flooding setting</li>
                        <li class="text-sm text-gray-700"><code class="px-2 py-1 bg-gray-100 rounded text-xs">unicastRoute</code> - Enable L3 routing</li>
                    </ul>
                </div>
                <p class="text-sm text-gray-700"><strong class="text-gray-900">Analysis Use:</strong> BD-EPG mapping, network segmentation analysis</p>
            </div>
        </details>

        <!-- vzBrCP -->
        <details class="group">
            <summary class="cursor-pointer px-6 py-4 hover:bg-gray-50 transition-colors">
                <div class="flex items-center justify-between">
                    <div class="flex items-center">
                        <svg class="h-5 w-5 text-gray-400 mr-3 group-open:rotate-90 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                        </svg>
                        <h3 class="text-lg font-semibold text-gray-900">vzBrCP <span class="text-sm font-normal text-gray-600">(Contract)</span></h3>
                    </div>
                    <span class="px-3 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800">ACI Object</span>
                </div>
            </summary>
            <div class="px-6 py-4 bg-gray-50">
                <p class="text-gray-700 mb-4"><strong class="text-gray-900">Description:</strong> Defines allowed communication between EPGs.</p>
                <div class="mb-4">
                    <p class="text-sm font-semibold text-gray-900 mb-2">Key Attributes:</p>
                    <ul class="space-y-1">
                        <li class="text-sm text-gray-700"><code class="px-2 py-1 bg-gray-100 rounded text-xs">name</code> - Contract name</li>
                        <li class="text-sm text-gray-700"><code class="px-2 py-1 bg-gray-100 rounded text-xs">scope</code> - Scope (context/tenant/global)</li>
                    </ul>
                </div>
                <p class="text-sm text-gray-700"><strong class="text-gray-900">Analysis Use:</strong> Cross-tenant dependency detection, migration planning</p>
            </div>
        </details>
    </div>
</div>

<!-- Analysis Methods & Data Collection (Side by Side) -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
    <!-- Analysis Methods -->
    <div class="bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden">
        <div class="px-6 py-4 bg-gradient-to-r from-purple-50 to-white border-b border-gray-200">
            <h2 class="text-2xl font-bold text-gray-900 flex items-center">
                <svg class="h-6 w-6 mr-2 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                </svg>
                Analysis Methods
            </h2>
        </div>
        <div class="p-6 space-y-4 max-h-96 overflow-y-auto">
            <div>
                <h3 class="text-lg font-semibold text-gray-900 mb-2">Port Utilization Analysis</h3>
                <p class="text-sm text-gray-700 mb-2">Calculates port usage across all FEX devices and assigns consolidation scores (0-100). Higher scores indicate better consolidation candidates.</p>
                <p class="text-sm font-semibold text-gray-900 mb-1">Scoring Factors:</p>
                <ul class="space-y-1 text-sm text-gray-700">
                    <li>• Port utilization percentage (lower = higher score)</li>
                    <li>• Operational status (down devices score higher)</li>
                    <li>• Interface count (fewer interfaces = higher score)</li>
                </ul>
            </div>

            <div>
                <h3 class="text-lg font-semibold text-gray-900 mb-2">Coupling Analysis</h3>
                <p class="text-sm text-gray-700 mb-2">Identifies dependencies and coupling issues that impact migration:</p>
                <ul class="space-y-1 text-sm text-gray-700">
                    <li>• Multi-device EPGs: EPGs deployed across multiple FEX or FEX+leaf</li>
                    <li>• Shared VLANs: VLAN namespace collisions across EPGs</li>
                    <li>• Cross-tenant contracts: Inter-tenant dependencies</li>
                </ul>
            </div>

            <div>
                <h3 class="text-lg font-semibold text-gray-900 mb-2">Migration Waves</h3>
                <p class="text-sm text-gray-700 mb-2">Groups EPGs into migration waves based on complexity and coupling:</p>
                <ul class="space-y-1 text-sm text-gray-700">
                    <li>• Wave 1: Standalone EPGs (no coupling) - 1 hr/EPG</li>
                    <li>• Wave 2: Low coupling - 2 hrs/EPG</li>
                    <li>• Wave 3: Medium coupling - 4 hrs/EPG</li>
                    <li>• Wave 4: High coupling - 8 hrs/EPG</li>
                </ul>
            </div>

            <div>
                <h3 class="text-lg font-semibold text-gray-900 mb-2">EPG Complexity Scoring</h3>
                <p class="text-sm text-gray-700 mb-2">Multi-factor complexity score (0-100) based on:</p>
                <ul class="space-y-1 text-sm text-gray-700">
                    <li>• Number of path attachments</li>
                    <li>• VLAN diversity</li>
                    <li>• Node spread (number of devices)</li>
                </ul>
                <p class="text-sm text-gray-700 mt-2">Complexity levels: Low (&lt;40), Medium (40-69), High (70+)</p>
            </div>
        </div>
    </div>

    <!-- Data Collection Guide -->
    <div class="bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden">
        <div class="px-6 py-4 bg-gradient-to-r from-green-50 to-white border-b border-gray-200">
            <h2 class="text-2xl font-bold text-gray-900 flex items-center">
                <svg class="h-6 w-6 mr-2 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/>
                </svg>
                Data Collection Guide
            </h2>
        </div>
        <div class="p-6 space-y-4 max-h-96 overflow-y-auto">
            <div>
                <h3 class="text-lg font-semibold text-gray-900 mb-2">Collecting ACI Data</h3>
                <p class="text-sm text-gray-700 mb-3">Use one of these methods to export ACI fabric data:</p>

                <h4 class="text-sm font-semibold text-gray-900 mb-2">Method 1: APIC GUI Export</h4>
                <pre class="bg-gray-900 text-green-400 rounded-lg p-3 text-xs overflow-x-auto mb-3"><code>1. Log in to APIC
2. Navigate to Tenants > Export
3. Select JSON format
4. Download the export file</code></pre>

                <h4 class="text-sm font-semibold text-gray-900 mb-2">Method 2: API Export (Recommended)</h4>
                <pre class="bg-gray-900 text-green-400 rounded-lg p-3 text-xs overflow-x-auto mb-3"><code>curl -X GET "https://&lt;apic-ip&gt;/api/node/class/fvAEPg.json" \
     -u "username:password" > epgs.json

curl -X GET "https://&lt;apic-ip&gt;/api/node/class/eqptFex.json" \
     -u "username:password" > fex.json</code></pre>

                <h4 class="text-sm font-semibold text-gray-900 mb-2">Method 3: moquery (CLI)</h4>
                <pre class="bg-gray-900 text-green-400 rounded-lg p-3 text-xs overflow-x-auto mb-3"><code>moquery -c fvAEPg -o json > epgs.json
moquery -c eqptFex -o json > fex.json
moquery -c fabricNode -o json > nodes.json</code></pre>
            </div>

            <div>
                <h3 class="text-lg font-semibold text-gray-900 mb-2">Preparing CMDB Data</h3>
                <p class="text-sm text-gray-700 mb-2">Create a CSV file with the following columns:</p>
                <ul class="space-y-1 text-sm">
                    <li><code class="px-2 py-1 bg-gray-100 rounded text-xs">device_name</code> - Device hostname</li>
                    <li><code class="px-2 py-1 bg-gray-100 rounded text-xs">serial_number</code> - Serial number (for correlation)</li>
                    <li><code class="px-2 py-1 bg-gray-100 rounded text-xs">model</code> - Device model</li>
                    <li><code class="px-2 py-1 bg-gray-100 rounded text-xs">location</code> - Physical location/datacenter</li>
                    <li><code class="px-2 py-1 bg-gray-100 rounded text-xs">rack</code> - Rack location</li>
                    <li><code class="px-2 py-1 bg-gray-100 rounded text-xs">status</code> - Operational status</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<!-- Troubleshooting & FAQ (Side by Side) -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
    <!-- Troubleshooting -->
    <div class="bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden">
        <div class="px-6 py-4 bg-gradient-to-r from-yellow-50 to-white border-b border-gray-200">
            <h2 class="text-2xl font-bold text-gray-900 flex items-center">
                <svg class="h-6 w-6 mr-2 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
                </svg>
                Troubleshooting
            </h2>
        </div>
        <div class="p-6 space-y-4">
            <div>
                <h4 class="text-sm font-semibold text-gray-900 mb-2">Upload Fails with "Invalid JSON"</h4>
                <p class="text-sm text-gray-700 mb-2"><strong>Solution:</strong> Ensure your JSON file is valid. Use a JSON validator or:</p>
                <pre class="bg-gray-900 text-green-400 rounded-lg p-3 text-xs overflow-x-auto"><code>python -m json.tool &lt; your_file.json</code></pre>
            </div>

            <div>
                <h4 class="text-sm font-semibold text-gray-900 mb-2">No Objects Found in Data</h4>
                <p class="text-sm text-gray-700"><strong>Solution:</strong> Verify your JSON file contains an "imdata" array with ACI objects.</p>
            </div>

            <div>
                <h4 class="text-sm font-semibold text-gray-900 mb-2">CMDB Correlation Shows 0%</h4>
                <p class="text-sm text-gray-700 mb-2"><strong>Solution:</strong> Check that:</p>
                <ul class="space-y-1 text-sm text-gray-700">
                    <li>• CSV file has a "serial_number" or "SerialNumber" column</li>
                    <li>• Serial numbers match between ACI and CMDB exactly</li>
                    <li>• No leading/trailing spaces in serial numbers</li>
                </ul>
            </div>

            <div>
                <h4 class="text-sm font-semibold text-gray-900 mb-2">Dashboards Not Loading</h4>
                <p class="text-sm text-gray-700 mb-2"><strong>Solution:</strong></p>
                <ul class="space-y-1 text-sm text-gray-700">
                    <li>• Ensure fabric has uploaded data</li>
                    <li>• Check browser console for JavaScript errors</li>
                    <li>• Clear browser cache and reload</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- FAQ -->
    <div class="bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden">
        <div class="px-6 py-4 bg-gradient-to-r from-teal-50 to-white border-b border-gray-200">
            <h2 class="text-2xl font-bold text-gray-900 flex items-center">
                <svg class="h-6 w-6 mr-2 text-teal-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                Frequently Asked Questions
            </h2>
        </div>
        <div class="p-6 space-y-4">
            <div>
                <h4 class="text-sm font-semibold text-gray-900 mb-1">Q: How long does analysis take?</h4>
                <p class="text-sm text-gray-700">A: Analysis of 1000+ EPGs typically completes in 10-15 seconds.</p>
            </div>

            <div>
                <h4 class="text-sm font-semibold text-gray-900 mb-1">Q: Can I analyze multiple fabrics?</h4>
                <p class="text-sm text-gray-700">A: Yes, create separate fabric entries for each datacenter or pod.</p>
            </div>

            <div>
                <h4 class="text-sm font-semibold text-gray-900 mb-1">Q: What's the difference between modes?</h4>
                <p class="text-sm text-gray-700">A: <strong class="text-gray-900">Offboard</strong> mode identifies consolidation opportunities. <strong class="text-gray-900">Onboard</strong> mode helps plan new deployments. <strong class="text-gray-900">EVPN Migration</strong> mode assists with fabric migration.</p>
            </div>

            <div>
                <h4 class="text-sm font-semibold text-gray-900 mb-1">Q: How accurate is the consolidation scoring?</h4>
                <p class="text-sm text-gray-700">A: Scoring is based on utilization, operational status, and interface count. Review recommendations manually before decommissioning.</p>
            </div>

            <div>
                <h4 class="text-sm font-semibold text-gray-900 mb-1">Q: Can I export analysis results?</h4>
                <p class="text-sm text-gray-700">A: Yes, use the Report page to generate HTML, Markdown, or CSV exports.</p>
            </div>
        </div>
    </div>
</div>

<!-- Support & Feedback -->
<div class="bg-gradient-to-br from-primary-50 to-blue-50 rounded-xl shadow-lg border border-primary-200 p-8">
    <div class="flex items-start">
        <div class="flex-shrink-0">
            <div class="h-12 w-12 rounded-xl bg-primary-600 flex items-center justify-center">
                <svg class="h-6 w-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 5.636l-3.536 3.536m0 5.656l3.536 3.536M9.172 9.172L5.636 5.636m3.536 9.192l-3.536 3.536M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-5 0a4 4 0 11-8 0 4 4 0 018 0z"/>
                </svg>
            </div>
        </div>
        <div class="ml-6">
            <h2 class="text-2xl font-bold text-gray-900 mb-3">Support & Feedback</h2>
            <p class="text-gray-700 mb-4">For issues, feature requests, or feedback:</p>
            <ul class="space-y-2">
                <li class="flex items-center text-gray-700">
                    <svg class="h-5 w-5 text-primary-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                    </svg>
                    <span><strong class="text-gray-900">GitHub Issues:</strong> <a href="https://github.com/sartios-source/acimig/issues" target="_blank" class="text-primary-600 hover:text-primary-800 underline">github.com/sartios-source/acimig/issues</a></span>
                </li>
                <li class="flex items-center text-gray-700">
                    <svg class="h-5 w-5 text-primary-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                    </svg>
                    <span><strong class="text-gray-900">Documentation:</strong> Check the README.md and docs/ folder</span>
                </li>
                <li class="flex items-center text-gray-700">
                    <svg class="h-5 w-5 text-primary-600 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                    </svg>
                    <span><strong class="text-gray-900">Security Issues:</strong> See docs/SECURITY_IMPROVEMENTS.md</span>
                </li>
            </ul>
        </div>
    </div>
</div>

{% endblock %}
